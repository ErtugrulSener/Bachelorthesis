<!DOCTYPE html>
<html>
    <head>
        <title>Abschlussarbeit - Ertuğrul Şener</title>

        <meta name="viewport" content="width=device-width, initial-scale=1">

        <link rel="stylesheet" type="text/css" href="style.css">
        <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/css/bootstrap.min.css" integrity="sha384-Gn5384xqQ1aoWXA+058RXPxPg6fy4IWvTNh0E263XmFcJlSAwiGgFAW/dAiS6JXm" crossorigin="anonymous">
        <link rel="icon" type="image/png" href="images/favicon.png" sizes="32x32">

        <!-- Bootstrap 4 Dependencies -->
        <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.0/css/bootstrap.min.css">
        <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
        <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/js/bootstrap.min.js"></script>

        <!-- External librarys-->
        <script src="scripts/utils/jsencrypt/jsencrypt.min.js"></script>
        <script src="scripts/utils/jssha/sha.js"></script>
        <script src="scripts/utils/jscookie/jscookie.js"></script>
        <script src="scripts/utils/jsunibabel/index.js"></script>
        <script src="https://unpkg.com/@simplewebauthn/browser/dist/simplewebauthn-browser.min.js"></script>

        <!-- Own librarys / modules -->
        <script src="scripts/form_handler.js"></script>
        <script src="scripts/authentication.js"></script>

        <script type="text/javascript">
            const session_cookie = clsec.getSessionCookie()
            if (session_cookie)
            {
                clsec.verifiedSuccessfully()
            }
        </script>
    </head>

    <body>
        <div class="header-flex-container">
            <a href="https://www.hft-leipzig.de/de/start.html"><img class="logo" src="images/telekom_logo.jpg"></a> &
            <a href="#"><img class="logo" src="images/clientless_logo.png"></a>
        </div>
        <form id="main_form">
            <div class="login-flex-container">
                <div class="flexbox-authentication-container">
                    <div id="flexbox_userpass" class="form-group">
                        <input class="form-control" type="text" id="username" name="username" placeholder="Benutzername" pattern=".{8,}" title="Mindestens 8 Zeichen" minlength=8 /><br>
                        <input class="form-control" type="password" id="password" name="password" placeholder="Passwort" pattern=".{8,}" title="Mindestens 8 Zeichen" minlength=8 />
                    </div>
                    <div id="flexbox_totp" class="flexbox_totp form-group">
                        <input class="form-control" type="text" id="totp_username" name="totp_username" placeholder="Benutzername" pattern=".{8,}" title="Mindestens 8 Zeichen" minlength=8 quired /><br>
                        <img id="totp_qr_image" class="totp_qr_image" /><br>
                        <a id="totp_secret" class="totp_secret"></a><br>
                        <input id="totp_token" class="totp_token" type="text" name="totp_token" placeholder="Sechsstelliger TOTP-Token" pattern=".{6,}" title="Mindestens 6 Zeichen" minlength=6 /><br>
                    </div>
                    <div id="flexbox_webauthn" class="form-group">
                        <input class="form-control" type="text" id="webauthn_username" name="webauthn_username" placeholder="Benutzername" pattern=".{8,}" title="Mindestens 8 Zeichen" minlength=8 /><br>
                    </div>
                </div>
                <div class="form-group">
                    <button type="button" class="btn btn-default" aria-label="Left Align" onclick="clsec.onDecreaseMethod()">
                        <span class="glyphicon glyphicon-chevron-left" aria-hidden="true"></span>
                    </button>
                    <select class="flexbox-method" id="method" onChange="clsec.onChangeAuthenticationMethod(this.value)">
                        <option class="form-check-label" value=0>Passwort</option>
                        <option class="form-check-label" value=1>Time Based OTP</option>
                        <option class="form-check-label" value=2>Web Authentication</option>
                    </select>
                    <button type="button" class="btn btn-default" aria-label="Left Align" onclick="clsec.onIncreaseMethod()">
                        <span class="glyphicon glyphicon-chevron-right" aria-hidden="true"></span>
                    </button>
                </div>
                <div class="form-group">
                    <input class="btn btn-primary" type="submit" id="webauthn_register_button" name="webauthn_register_button" value="Gerät registrieren" />
                    <input class="btn btn-primary" type="submit" id="submit" name="submit" value="Authentifizieren" />
                </div>
            </div>
        </form>
      </body>
</html>